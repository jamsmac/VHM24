# üåê VENDHUB ECOSYSTEM ‚Äî –§–ò–ù–ê–õ–¨–ù–´–ô –ü–õ–ê–ù

> **VendHub ‚Äî –µ–¥–∏–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –≤–µ–Ω–¥–∏–Ω–≥–∞, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ —Å–∞–π—Ç, –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ Telegram, –æ–±—ä–µ–¥–∏–Ω—è—è –ø–æ–∫—É–ø–∫–∏, –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å–æ–º –≤ –æ–¥–Ω–æ–º –ø–æ–Ω—è—Ç–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ.**

**–î–∞—Ç–∞:** 23 –¥–µ–∫–∞–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 4.0 FINAL  
**–°—Ç–∞—Ç—É—Å:** Ready for Implementation

---

## üìã –û–ì–õ–ê–í–õ–ï–ù–ò–ï

1. [–§–∏–ª–æ—Å–æ—Ñ–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã](#1-—Ñ–∏–ª–æ—Å–æ—Ñ–∏—è-—ç–∫–æ—Å–∏—Å—Ç–µ–º—ã)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã](#2-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)
3. [–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ GAP-–∞–Ω–∞–ª–∏–∑](#3-—Ç–µ–∫—É—â–µ–µ-—Å–æ—Å—Ç–æ—è–Ω–∏–µ)
4. [Sprint 0: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è](#4-sprint-0-blockers)
5. [Sprint 1: Office UX](#5-sprint-1-office-ux)
6. [Sprint 2: –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –∑–æ–Ω–∞](#6-sprint-2-–∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è-–∑–æ–Ω–∞)
7. [Sprint 3: Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è](#7-sprint-3-telegram)
8. [Sprint 4: –§—Ä–∞–Ω—á–∞–π–∑–∏–Ω–≥](#8-sprint-4-—Ñ—Ä–∞–Ω—á–∞–π–∑–∏–Ω–≥)
9. [Roadmap](#9-roadmap)

---

## 1. –§–ò–õ–û–°–û–§–ò–Ø –≠–ö–û–°–ò–°–¢–ï–ú–´

### –û–¥–∏–Ω –±—Ä–µ–Ω–¥ ‚Äî —Ä–∞–∑–Ω—ã–µ —Ä–æ–ª–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        üåê VENDHUB                               ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ    "–£–¥–æ–±–Ω—ã–π —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—Å–µ–≥–¥–∞ –ø–æ–¥ —Ä—É–∫–æ–π ‚Äî                 ‚îÇ
‚îÇ     –≤ —Ç–µ–ª–µ—Ñ–æ–Ω–µ, –±—Ä–∞—É–∑–µ—Ä–µ –∏–ª–∏ –≤ Telegram"                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                 ‚îÇ
‚îÇ  üë§ –ö–õ–ò–ï–ù–¢          üë∑ –°–û–¢–†–£–î–ù–ò–ö        üëî –í–õ–ê–î–ï–õ–ï–¶            ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ          ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ          ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ              ‚îÇ
‚îÇ  ‚Ä¢ –ü–æ–∫—É–ø–∫–∏          ‚Ä¢ –ó–∞–¥–∞—á–∏            ‚Ä¢ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞            ‚îÇ
‚îÇ  ‚Ä¢ –ë–æ–Ω—É—Å—ã           ‚Ä¢ –û—Ç—á—ë—Ç—ã            ‚Ä¢ –§–∏–Ω–∞–Ω—Å—ã              ‚îÇ
‚îÇ  ‚Ä¢ –ò—Å—Ç–æ—Ä–∏—è          ‚Ä¢ –ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã         ‚Ä¢ –ö–æ–Ω—Ç—Ä–æ–ª—å             ‚îÇ
‚îÇ  ‚Ä¢ –ê–∫—Ü–∏–∏            ‚Ä¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è       ‚Ä¢ –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ      ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  üì± App / üåê Web / üí¨ Telegram                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–∏–Ω—Ü–∏–ø—ã —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã

| –ü—Ä–∏–Ω—Ü–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| **–ï–¥–∏–Ω—ã–π –≤—Ö–æ–¥** | –û–¥–∏–Ω –∞–∫–∫–∞—É–Ω—Ç –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º |
| **–†–æ–ª—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** | –ö–∞–∂–¥—ã–π –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ—ë |
| **–ö–∞–Ω–∞–ª –ø–æ –≤—ã–±–æ—Ä—É** | –°–∞–π—Ç, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ Telegram ‚Äî –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –æ–ø—ã—Ç |
| **–î–∞–Ω–Ω—ã–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤–µ–∑–¥–µ |

---

## 2. –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ü–õ–ê–¢–§–û–†–ú–´

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–º–µ–Ω–æ–≤

```
vendhub.live              ‚Äî –ü—É–±–ª–∏—á–Ω—ã–π —Å–∞–π—Ç –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ /locations            ‚Äî –ö–∞—Ä—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–æ–≤
‚îú‚îÄ‚îÄ /menu                 ‚Äî –ú–µ–Ω—é –∏ —Ü–µ–Ω—ã
‚îú‚îÄ‚îÄ /promotions           ‚Äî –ê–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ /my                   ‚Äî –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ (NEW)
‚îÇ   ‚îú‚îÄ‚îÄ /history          ‚Äî –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ /bonuses          ‚Äî –ë–æ–Ω—É—Å—ã –∏ –±–∞–ª–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ /settings         ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∏
‚îî‚îÄ‚îÄ /cooperation          ‚Äî –î–ª—è –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤

office.vendhub.live       ‚Äî –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (VHM24)
‚îú‚îÄ‚îÄ /dashboard            ‚Äî –ì–ª–∞–≤–Ω–∞—è
‚îú‚îÄ‚îÄ /machines             ‚Äî –ê–≤—Ç–æ–º–∞—Ç—ã
‚îú‚îÄ‚îÄ /tasks                ‚Äî –ó–∞–¥–∞—á–∏
‚îú‚îÄ‚îÄ /transactions         ‚Äî –§–∏–Ω–∞–Ω—Å—ã
‚îî‚îÄ‚îÄ /settings             ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∏

api.vendhub.live          ‚Äî –ï–¥–∏–Ω—ã–π API
‚îú‚îÄ‚îÄ /auth                 ‚Äî –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ /public               ‚Äî –ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îú‚îÄ‚îÄ /customer             ‚Äî API –∫–ª–∏–µ–Ω—Ç–æ–≤ (NEW)
‚îú‚îÄ‚îÄ /staff                ‚Äî API —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
‚îî‚îÄ‚îÄ /admin                ‚Äî API –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
```

### –†–æ–ª–∏ –∏ –¥–æ—Å—Ç—É–ø—ã

```typescript
// –ü–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–∞ —Ä–æ–ª–µ–π —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã
export enum UserRole {
  // –ö–ª–∏–µ–Ω—Ç—ã (Public)
  CUSTOMER = 'Customer',
  
  // –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ (Office + Mobile + Telegram)
  OPERATOR = 'Operator',      // –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
  COLLECTOR = 'Collector',    // –ò–Ω–∫–∞—Å—Å–∞—Ü–∏—è
  TECHNICIAN = 'Technician',  // –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
  
  // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (Office + Telegram)
  MANAGER = 'Manager',
  ADMIN = 'Admin',
  
  // –í–ª–∞–¥–µ–ª—å—Ü—ã (Office)
  OWNER = 'Owner',
  FRANCHISEE = 'Franchisee',
}

export const ROLE_ACCESS = {
  [UserRole.CUSTOMER]: {
    platforms: ['web', 'mobile', 'telegram'],
    areas: ['public', 'customer-cabinet'],
  },
  [UserRole.OPERATOR]: {
    platforms: ['office', 'mobile', 'telegram'],
    areas: ['tasks', 'machines-view', 'inventory'],
  },
  [UserRole.COLLECTOR]: {
    platforms: ['office', 'mobile', 'telegram'],
    areas: ['collections', 'machines-view', 'finance-view'],
  },
  [UserRole.TECHNICIAN]: {
    platforms: ['office', 'mobile', 'telegram'],
    areas: ['maintenance', 'equipment', 'incidents'],
  },
  [UserRole.MANAGER]: {
    platforms: ['office', 'telegram'],
    areas: ['full-read', 'tasks-manage', 'reports'],
  },
  [UserRole.ADMIN]: {
    platforms: ['office'],
    areas: ['full-access', 'users', 'settings'],
  },
  [UserRole.OWNER]: {
    platforms: ['office'],
    areas: ['everything'],
  },
  [UserRole.FRANCHISEE]: {
    platforms: ['office'],
    areas: ['own-organization'],
  },
};
```

---

## 3. –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï

### ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ VHM24

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å |
|-----------|--------|------------|
| Office Dashboard | ‚úÖ | 85% |
| 2FA –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è | ‚úÖ | 100% |
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—à–∏–Ω–∞–º–∏ | ‚úÖ | 90% |
| –°–∏—Å—Ç–µ–º–∞ –∑–∞–¥–∞—á | ‚úÖ | 85% |
| Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | ‚úÖ | 70% |
| Public Landing | ‚úÖ | 60% |
| –ö–∞—Ä—Ç–∞ –ª–æ–∫–∞—Ü–∏–π | ‚úÖ | 80% |

### ‚ùå GAP-–∞–Ω–∞–ª–∏–∑: —á—Ç–æ –Ω—É–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å

| –ü—Ä–æ–±–ª–µ–º–∞ | –ì–¥–µ | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|----------|-----|-------------|
| Role mismatch (5 vs 7 —Ä–æ–ª–µ–π) | `types/users.ts` | üî¥ BLOCKER |
| Currency RUB ‚Üí UZS | `lib/utils.ts` | üî¥ BLOCKER |
| Sidebar –±–µ–∑ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ | `components/layout/` | üü† HIGH |
| –ù–µ—Ç –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞ | `app/(public)/` | üü† HIGH |
| –ù–µ—Ç –±–æ–Ω—É—Å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã | Backend + Frontend | üü° MEDIUM |
| –ù–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel | UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã | üü° MEDIUM |
| –ù–µ—Ç onboarding —Ç—É—Ä–∞ | UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã | üü¢ LOW |

---

## 4. SPRINT 0: BLOCKERS (–î–µ–Ω—å 1, 3 —á–∞—Å–∞)

### 4.1 Fix Role Mismatch

**–ü—Ä–æ–±–ª–µ–º–∞:** Frontend –∏–º–µ–µ—Ç 5 —Ä–æ–ª–µ–π (lowercase), Backend ‚Äî 7 —Ä–æ–ª–µ–π (PascalCase)

**–§–∞–π–ª:** `frontend/src/types/users.ts` ‚Äî –ü–û–õ–ù–ê–Ø –ó–ê–ú–ï–ù–ê

```typescript
// ============================================
// VENDHUB ECOSYSTEM - USER TYPES
// ============================================

export enum UserRole {
  // –ö–ª–∏–µ–Ω—Ç—ã
  CUSTOMER = 'Customer',
  
  // –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏
  OPERATOR = 'Operator',
  COLLECTOR = 'Collector',
  TECHNICIAN = 'Technician',
  
  // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
  MANAGER = 'Manager',
  ADMIN = 'Admin',
  
  // –í–ª–∞–¥–µ–ª—å—Ü—ã
  OWNER = 'Owner',
  VIEWER = 'Viewer',
}

export const ROLE_CONFIG: Record<UserRole, {
  label: string;
  labelRu: string;
  icon: string;
  color: string;
  bgClass: string;
  textClass: string;
  description: string;
}> = {
  [UserRole.CUSTOMER]: {
    label: 'Customer',
    labelRu: '–ö–ª–∏–µ–Ω—Ç',
    icon: 'üë§',
    color: 'sky',
    bgClass: 'bg-sky-100',
    textClass: 'text-sky-800',
    description: '–ü–æ–∫—É–ø–∞—Ç–µ–ª—å –Ω–∞–ø–∏—Ç–∫–æ–≤',
  },
  [UserRole.OPERATOR]: {
    label: 'Operator',
    labelRu: '–û–ø–µ—Ä–∞—Ç–æ—Ä',
    icon: 'üîß',
    color: 'green',
    bgClass: 'bg-green-100',
    textClass: 'text-green-800',
    description: '–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–æ–≤',
  },
  [UserRole.COLLECTOR]: {
    label: 'Collector',
    labelRu: '–ò–Ω–∫–∞—Å—Å–∞—Ç–æ—Ä',
    icon: 'üí∞',
    color: 'yellow',
    bgClass: 'bg-yellow-100',
    textClass: 'text-yellow-800',
    description: '–°–±–æ—Ä –Ω–∞–ª–∏—á–Ω—ã—Ö',
  },
  [UserRole.TECHNICIAN]: {
    label: 'Technician',
    labelRu: '–¢–µ—Ö–Ω–∏–∫',
    icon: 'üõ†Ô∏è',
    color: 'orange',
    bgClass: 'bg-orange-100',
    textClass: 'text-orange-800',
    description: '–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ —Ä–µ–º–æ–Ω—Ç',
  },
  [UserRole.MANAGER]: {
    label: 'Manager',
    labelRu: '–ú–µ–Ω–µ–¥–∂–µ—Ä',
    icon: 'üìä',
    color: 'blue',
    bgClass: 'bg-blue-100',
    textClass: 'text-blue-800',
    description: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏',
  },
  [UserRole.ADMIN]: {
    label: 'Admin',
    labelRu: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
    icon: '‚öôÔ∏è',
    color: 'red',
    bgClass: 'bg-red-100',
    textClass: 'text-red-800',
    description: '–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ',
  },
  [UserRole.OWNER]: {
    label: 'Owner',
    labelRu: '–í–ª–∞–¥–µ–ª–µ—Ü',
    icon: 'üëë',
    color: 'purple',
    bgClass: 'bg-purple-100',
    textClass: 'text-purple-800',
    description: '–í–ª–∞–¥–µ–ª–µ—Ü –±–∏–∑–Ω–µ—Å–∞',
  },
  [UserRole.VIEWER]: {
    label: 'Viewer',
    labelRu: '–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å',
    icon: 'üëÅÔ∏è',
    color: 'gray',
    bgClass: 'bg-gray-100',
    textClass: 'text-gray-800',
    description: '–¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä',
  },
};

export function getRoleConfig(role: UserRole | string) {
  return ROLE_CONFIG[role as UserRole] || ROLE_CONFIG[UserRole.VIEWER];
}

export interface User {
  id: string;
  email: string;
  username?: string;
  full_name: string;
  role: UserRole;
  phone?: string;
  is_active: boolean;
  status?: 'pending' | 'active' | 'password_change_required' | 'inactive' | 'suspended';
  telegram_user_id?: string;
  is_2fa_enabled?: boolean;
  organization_id?: string; // –î–ª—è —Ñ—Ä–∞–Ω—á–∞–π–∑–∏
  created_at: string;
  updated_at: string;
  last_login?: string;
}
```

---

### 4.2 Fix Currency (RUB ‚Üí UZS)

**–§–∞–π–ª:** `frontend/src/lib/utils.ts` ‚Äî –∑–∞–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é formatCurrency

```typescript
// ============================================
// VENDHUB - CURRENCY UTILITIES (UZS)
// ============================================

export const CURRENCY = {
  code: 'UZS',
  symbol: '—Å—û–º',
  symbolShort: '—Å—É–º',
  locale: 'uz-UZ',
} as const;

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É–º–º—ã –≤ —É–∑–±–µ–∫—Å–∫–∏—Ö —Å—É–º–∞—Ö
 * @example formatCurrency(1500000) ‚Üí "1 500 000 —Å—É–º"
 * @example formatCurrency(1500000, { compact: true }) ‚Üí "1.5 –º–ª–Ω"
 */
export function formatCurrency(
  amount: number | null | undefined,
  options?: {
    showSymbol?: boolean;
    compact?: boolean;
    decimals?: number;
  }
): string {
  if (amount === null || amount === undefined) return '‚Äî';
  
  const { showSymbol = true, compact = false, decimals = 0 } = options || {};
  
  let formatted: string;
  
  if (compact) {
    const abs = Math.abs(amount);
    if (abs >= 1_000_000_000) {
      formatted = (amount / 1_000_000_000).toFixed(1).replace('.0', '') + ' –º–ª—Ä–¥';
    } else if (abs >= 1_000_000) {
      formatted = (amount / 1_000_000).toFixed(1).replace('.0', '') + ' –º–ª–Ω';
    } else if (abs >= 1_000) {
      formatted = (amount / 1_000).toFixed(1).replace('.0', '') + ' —Ç—ã—Å';
    } else {
      formatted = amount.toFixed(decimals);
    }
  } else {
    formatted = new Intl.NumberFormat('ru-RU', {
      minimumFractionDigits: decimals,
      maximumFractionDigits: decimals,
    }).format(amount);
  }
  
  return showSymbol ? `${formatted} ${CURRENCY.symbolShort}` : formatted;
}

/**
 * –ö–æ—Ä–æ—Ç–∫–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –∫–∞—Ä—Ç–æ—á–µ–∫
 * @example formatCurrencyShort(15000000) ‚Üí "15M"
 */
export function formatCurrencyShort(amount: number): string {
  if (amount >= 1_000_000_000) return (amount / 1_000_000_000).toFixed(1) + 'B';
  if (amount >= 1_000_000) return (amount / 1_000_000).toFixed(1) + 'M';
  if (amount >= 1_000) return (amount / 1_000).toFixed(0) + 'K';
  return amount.toString();
}
```

**–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –∑–∞–º–µ–Ω—ã:**
```bash
# –ù–∞–π—Ç–∏ –≤—Å–µ –º–µ—Å—Ç–∞ —Å RUB/‚ÇΩ
grep -rn "RUB\|‚ÇΩ\|—Ä—É–±" frontend/src --include="*.tsx" --include="*.ts"

# –ó–∞–º–µ–Ω–∏—Ç—å
sed -i 's/‚ÇΩ/—Å—É–º/g' frontend/src/**/*.tsx
sed -i "s/'RUB'/'UZS'/g" frontend/src/**/*.ts
```

---

## 5. SPRINT 1: OFFICE UX (–ù–µ–¥–µ–ª—è 1, 11 —á–∞—Å–æ–≤)

### 5.1 Collapsible Sidebar —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π

**–§–∞–π–ª:** `frontend/src/components/layout/Sidebar.tsx` ‚Äî –ü–û–õ–ù–ê–Ø –ó–ê–ú–ï–ù–ê

```typescript
'use client'

import { useState, useEffect } from 'react'
import Link from 'next/link'
import { usePathname } from 'next/navigation'
import {
  LayoutDashboard, Package, ClipboardList, AlertTriangle,
  MessageSquare, DollarSign, Users, MapPin, Map, Settings,
  Shield, Bell, BellRing, BarChart3, Wrench, Send, Building2,
  FileText, Receipt, FileUp, Activity, ScrollText, Timer,
  KeyRound, ChevronDown, ChevronRight, Coffee, ExternalLink,
} from 'lucide-react'
import { cn } from '@/lib/utils'
import { useActiveAlertsCount } from '@/hooks/useActiveAlertsCount'

// –ù–∞–≤–∏–≥–∞—Ü–∏—è —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ –ª–æ–≥–∏–∫–µ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã VendHub
const NAVIGATION_GROUPS = [
  {
    id: 'overview',
    label: '–û–±–∑–æ—Ä',
    icon: LayoutDashboard,
    defaultOpen: true,
    items: [
      { name: 'Dashboard', href: '/dashboard', icon: LayoutDashboard },
    ]
  },
  {
    id: 'machines',
    label: '–ê–≤—Ç–æ–º–∞—Ç—ã',
    icon: Coffee,
    defaultOpen: true,
    items: [
      { name: '–í—Å–µ –∞–ø–ø–∞—Ä–∞—Ç—ã', href: '/dashboard/machines', icon: Package },
      { name: '–î–æ—Å—Ç—É–ø', href: '/dashboard/machines/access', icon: KeyRound },
      { name: '–ö–∞—Ä—Ç–∞', href: '/dashboard/map', icon: Map },
      { name: '–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥', href: '/dashboard/monitoring', icon: Activity },
    ]
  },
  {
    id: 'operations',
    label: '–û–ø–µ—Ä–∞—Ü–∏–∏',
    icon: ClipboardList,
    defaultOpen: true,
    items: [
      { name: '–ó–∞–¥–∞—á–∏', href: '/dashboard/tasks', icon: ClipboardList },
      { name: '–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ', href: '/dashboard/scheduled-tasks', icon: Timer },
      { name: '–ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã', href: '/dashboard/incidents', icon: AlertTriangle },
      { name: '–ñ–∞–ª–æ–±—ã', href: '/dashboard/complaints', icon: MessageSquare },
    ]
  },
  {
    id: 'inventory',
    label: '–°–∫–ª–∞–¥ –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ',
    icon: Wrench,
    items: [
      { name: '–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å', href: '/dashboard/inventory', icon: Package },
      { name: '–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ', href: '/dashboard/equipment', icon: Wrench },
      { name: '–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö', href: '/dashboard/import', icon: FileUp },
    ]
  },
  {
    id: 'finance',
    label: '–§–∏–Ω–∞–Ω—Å—ã',
    icon: DollarSign,
    items: [
      { name: '–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏', href: '/dashboard/transactions', icon: DollarSign },
      { name: '–ö–æ–º–∏—Å—Å–∏–∏', href: '/dashboard/commissions', icon: Receipt },
      { name: '–î–æ–≥–æ–≤–æ—Ä—ã', href: '/dashboard/contracts', icon: FileText },
      { name: '–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—ã', href: '/dashboard/counterparties', icon: Building2 },
      { name: '–û—Ç—á—ë—Ç—ã', href: '/dashboard/reports', icon: BarChart3 },
    ]
  },
  {
    id: 'notifications',
    label: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è',
    icon: Bell,
    items: [
      { name: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è', href: '/dashboard/notifications', icon: Bell },
      { name: '–û–ø–æ–≤–µ—â–µ–Ω–∏—è', href: '/dashboard/alerts', icon: BellRing, badge: true },
    ]
  },
  {
    id: 'admin',
    label: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ',
    icon: Settings,
    items: [
      { name: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏', href: '/dashboard/users', icon: Users },
      { name: '–õ–æ–∫–∞—Ü–∏–∏', href: '/dashboard/locations', icon: MapPin },
      { name: 'Telegram', href: '/dashboard/telegram', icon: Send },
      { name: '–ê—É–¥–∏—Ç', href: '/dashboard/audit', icon: ScrollText },
      { name: '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', href: '/dashboard/security', icon: Shield },
      { name: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏', href: '/dashboard/settings', icon: Settings },
    ]
  },
];

// Hook –¥–ª—è localStorage
function useLocalStorage<T>(key: string, initial: T): [T, (v: T) => void] {
  const [value, setValue] = useState<T>(initial);
  
  useEffect(() => {
    const stored = localStorage.getItem(key);
    if (stored) setValue(JSON.parse(stored));
  }, [key]);
  
  const set = (v: T) => {
    setValue(v);
    localStorage.setItem(key, JSON.stringify(v));
  };
  
  return [value, set];
}

function AlertsBadge() {
  const { count } = useActiveAlertsCount();
  if (!count) return null;
  return (
    <span className="ml-auto px-2 py-0.5 text-xs font-medium rounded-full bg-red-100 text-red-700">
      {count > 99 ? '99+' : count}
    </span>
  );
}

export function Sidebar() {
  const pathname = usePathname();
  const [expanded, setExpanded] = useLocalStorage<string[]>(
    'vhm24-nav-expanded',
    NAVIGATION_GROUPS.filter(g => g.defaultOpen).map(g => g.id)
  );

  // Auto-expand active group
  useEffect(() => {
    const activeGroup = NAVIGATION_GROUPS.find(g =>
      g.items.some(i => pathname === i.href || pathname?.startsWith(i.href + '/'))
    );
    if (activeGroup && !expanded.includes(activeGroup.id)) {
      setExpanded([...expanded, activeGroup.id]);
    }
  }, [pathname]);

  const toggle = (id: string) => {
    setExpanded(expanded.includes(id) 
      ? expanded.filter(x => x !== id) 
      : [...expanded, id]
    );
  };

  const isActive = (href: string) => 
    pathname === href || pathname?.startsWith(href + '/');

  return (
    <aside className="hidden md:flex flex-col w-64 bg-white border-r h-screen">
      {/* Logo */}
      <div className="p-4 border-b">
        <Link href="/dashboard" className="flex items-center gap-3">
          <div className="w-10 h-10 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-xl flex items-center justify-center">
            <Coffee className="w-5 h-5 text-white" />
          </div>
          <div>
            <div className="font-bold text-gray-900">VendHub</div>
            <div className="text-xs text-gray-500">Office</div>
          </div>
        </Link>
      </div>

      {/* Navigation */}
      <nav className="flex-1 overflow-y-auto p-3">
        {NAVIGATION_GROUPS.map((group) => {
          const isOpen = expanded.includes(group.id);
          const hasActive = group.items.some(i => isActive(i.href));
          const Icon = group.icon;

          return (
            <div key={group.id} className="mb-1">
              <button
                onClick={() => toggle(group.id)}
                className={cn(
                  'w-full flex items-center justify-between px-3 py-2 text-sm font-medium rounded-lg transition',
                  hasActive ? 'bg-indigo-50 text-indigo-700' : 'text-gray-600 hover:bg-gray-50'
                )}
              >
                <span className="flex items-center gap-3">
                  <Icon className="w-5 h-5" />
                  {group.label}
                </span>
                {isOpen ? <ChevronDown className="w-4 h-4" /> : <ChevronRight className="w-4 h-4" />}
              </button>

              <div className={cn(
                'overflow-hidden transition-all',
                isOpen ? 'max-h-96 opacity-100' : 'max-h-0 opacity-0'
              )}>
                <ul className="mt-1 ml-4 pl-3 border-l-2 border-gray-100 space-y-0.5">
                  {group.items.map((item) => {
                    const ItemIcon = item.icon;
                    const active = isActive(item.href);
                    
                    return (
                      <li key={item.href}>
                        <Link
                          href={item.href}
                          className={cn(
                            'flex items-center px-3 py-2 text-sm rounded-md transition',
                            active
                              ? 'bg-indigo-100 text-indigo-700 font-medium'
                              : 'text-gray-600 hover:bg-gray-50'
                          )}
                        >
                          <ItemIcon className="mr-3 w-4 h-4" />
                          <span className="flex-1">{item.name}</span>
                          {item.badge && <AlertsBadge />}
                        </Link>
                      </li>
                    );
                  })}
                </ul>
              </div>
            </div>
          );
        })}
      </nav>

      {/* Ecosystem Links */}
      <div className="p-3 border-t space-y-1">
        <a
          href="https://vendhub.live"
          target="_blank"
          rel="noopener"
          className="flex items-center gap-2 px-3 py-2 text-sm text-gray-500 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition"
        >
          <ExternalLink className="w-4 h-4" />
          vendhub.live
        </a>
        <a
          href="https://t.me/VendHubBot"
          target="_blank"
          rel="noopener"
          className="flex items-center gap-2 px-3 py-2 text-sm text-gray-500 hover:text-blue-500 hover:bg-blue-50 rounded-lg transition"
        >
          <Send className="w-4 h-4" />
          @VendHubBot
        </a>
        <div className="text-xs text-gray-400 text-center pt-2">
          VendHub Ecosystem v2.0
        </div>
      </div>
    </aside>
  );
}
```

---

### 5.2 Excel Export Component

**–§–∞–π–ª:** `frontend/src/components/ui/ExportButton.tsx`

```typescript
'use client'

import { useState } from 'react'
import { Download, FileSpreadsheet, FileText, ChevronDown, Loader2 } from 'lucide-react'
import { cn } from '@/lib/utils'

interface Column<T> {
  key: keyof T;
  header: string;
  format?: (value: any, row: T) => string;
}

interface Props<T> {
  data: T[];
  columns: Column<T>[];
  filename: string;
  className?: string;
}

export function ExportButton<T extends Record<string, any>>({ 
  data, columns, filename, className 
}: Props<T>) {
  const [open, setOpen] = useState(false);
  const [loading, setLoading] = useState(false);

  const exportCSV = () => {
    setLoading(true);
    setOpen(false);
    
    try {
      const headers = columns.map(c => c.header).join(',');
      const rows = data.map(row =>
        columns.map(c => {
          const val = c.format ? c.format(row[c.key], row) : row[c.key];
          const str = String(val ?? '').replace(/"/g, '""');
          return str.includes(',') ? `"${str}"` : str;
        }).join(',')
      ).join('\n');
      
      const blob = new Blob([`\uFEFF${headers}\n${rows}`], { type: 'text/csv;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${filename}-${new Date().toISOString().split('T')[0]}.csv`;
      a.click();
      URL.revokeObjectURL(url);
    } finally {
      setLoading(false);
    }
  };

  const exportExcel = async () => {
    setLoading(true);
    setOpen(false);
    
    try {
      const XLSX = await import('xlsx');
      const exportData = data.map(row => {
        const obj: Record<string, any> = {};
        columns.forEach(c => {
          obj[c.header] = c.format ? c.format(row[c.key], row) : row[c.key];
        });
        return obj;
      });
      
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.json_to_sheet(exportData);
      XLSX.utils.book_append_sheet(wb, ws, 'Data');
      XLSX.writeFile(wb, `${filename}-${new Date().toISOString().split('T')[0]}.xlsx`);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className={cn('relative', className)}>
      <button
        onClick={() => setOpen(!open)}
        disabled={loading || !data.length}
        className="flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg border bg-white hover:bg-gray-50 disabled:opacity-50"
      >
        {loading ? <Loader2 className="w-4 h-4 animate-spin" /> : <Download className="w-4 h-4" />}
        –≠–∫—Å–ø–æ—Ä—Ç
        <ChevronDown className="w-4 h-4" />
      </button>

      {open && (
        <>
          <div className="fixed inset-0 z-10" onClick={() => setOpen(false)} />
          <div className="absolute right-0 mt-2 w-48 bg-white border rounded-lg shadow-lg z-20">
            <button onClick={exportExcel} className="w-full flex items-center gap-3 px-4 py-3 text-sm hover:bg-gray-50">
              <FileSpreadsheet className="w-5 h-5 text-green-600" />
              Excel (.xlsx)
            </button>
            <button onClick={exportCSV} className="w-full flex items-center gap-3 px-4 py-3 text-sm hover:bg-gray-50 border-t">
              <FileText className="w-5 h-5 text-blue-600" />
              CSV (.csv)
            </button>
          </div>
        </>
      )}
    </div>
  );
}
```

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
cd frontend && npm install xlsx
```

---

## 6. SPRINT 2: –ö–õ–ò–ï–ù–¢–°–ö–ê–Ø –ó–û–ù–ê (–ù–µ–¥–µ–ª—è 2, 12 —á–∞—Å–æ–≤)

### 6.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞

```
frontend/src/app/(public)/
‚îú‚îÄ‚îÄ page.tsx                  ‚úÖ Landing (–æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É)
‚îú‚îÄ‚îÄ locations/page.tsx        ‚úÖ –ö–∞—Ä—Ç–∞
‚îú‚îÄ‚îÄ menu/page.tsx             ‚úÖ –ú–µ–Ω—é
‚îú‚îÄ‚îÄ cooperation/page.tsx      ‚úÖ –ü–∞—Ä—Ç–Ω—ë—Ä—Å—Ç–≤–æ
‚îÇ
‚îú‚îÄ‚îÄ my/                       üÜï –ù–û–í–û–ï - –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx              üÜï Dashboard –∫–ª–∏–µ–Ω—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ history/page.tsx      üÜï –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ bonuses/page.tsx      üÜï –ë–æ–Ω—É—Å—ã –∏ –±–∞–ª–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ favorites/page.tsx    üÜï –õ—é–±–∏–º—ã–µ –Ω–∞–ø–∏—Ç–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ settings/page.tsx     üÜï –ù–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ
‚îî‚îÄ‚îÄ promotions/page.tsx       üÜï –ê–∫—Ü–∏–∏
```

### 6.2 Customer Dashboard

**–§–∞–π–ª:** `frontend/src/app/(public)/my/page.tsx`

```typescript
'use client'

import { useEffect, useState } from 'react'
import Link from 'next/link'
import { Coffee, Gift, History, Settings, Star, TrendingUp, Heart } from 'lucide-react'
import { formatCurrency } from '@/lib/utils'

interface CustomerStats {
  totalPurchases: number;
  totalSpent: number;
  bonusPoints: number;
  level: 'Bronze' | 'Silver' | 'Gold' | 'Platinum';
  favoriteDrink?: string;
  nextLevelProgress: number;
}

const LEVELS = {
  Bronze: { min: 0, max: 999, multiplier: 1.0, color: 'amber' },
  Silver: { min: 1000, max: 4999, multiplier: 1.2, color: 'gray' },
  Gold: { min: 5000, max: 9999, multiplier: 1.5, color: 'yellow' },
  Platinum: { min: 10000, max: Infinity, multiplier: 2.0, color: 'purple' },
};

export default function CustomerDashboard() {
  const [stats, setStats] = useState<CustomerStats | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetch('/api/customer/me/stats')
      .then(r => r.json())
      .then(setStats)
      .catch(() => setStats({
        totalPurchases: 47,
        totalSpent: 523000,
        bonusPoints: 2340,
        level: 'Silver',
        favoriteDrink: '–ö–∞–ø—É—á–∏–Ω–æ',
        nextLevelProgress: 68,
      }))
      .finally(() => setLoading(false));
  }, []);

  if (loading) {
    return (
      <div className="container mx-auto px-4 py-12">
        <div className="animate-pulse space-y-6">
          <div className="h-8 w-48 bg-gray-200 rounded" />
          <div className="grid gap-6 md:grid-cols-4">
            {[1,2,3,4].map(i => <div key={i} className="h-32 bg-gray-200 rounded-xl" />)}
          </div>
        </div>
      </div>
    );
  }

  const level = stats?.level || 'Bronze';
  const levelConfig = LEVELS[level];

  return (
    <div className="container mx-auto px-4 py-8">
      {/* Header */}
      <div className="flex items-center justify-between mb-8">
        <div>
          <h1 className="text-3xl font-bold text-gray-900">–ú–æ–π –∫–∞–±–∏–Ω–µ—Ç</h1>
          <p className="text-gray-500 mt-1">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ VendHub!</p>
        </div>
        <Link 
          href="/my/settings"
          className="p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100"
        >
          <Settings className="w-6 h-6" />
        </Link>
      </div>

      {/* Level Card */}
      <div className={`bg-gradient-to-r from-${levelConfig.color}-500 to-${levelConfig.color}-600 rounded-2xl p-6 text-white mb-8`}>
        <div className="flex items-center justify-between">
          <div>
            <div className="flex items-center gap-2 mb-2">
              <Star className="w-6 h-6" />
              <span className="text-lg font-semibold">{level} —É—Ä–æ–≤–µ–Ω—å</span>
            </div>
            <div className="text-sm opacity-90">
              –ë–æ–Ω—É—Å x{levelConfig.multiplier} –∫ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è–º
            </div>
          </div>
          <div className="text-right">
            <div className="text-4xl font-bold">{stats?.bonusPoints?.toLocaleString()}</div>
            <div className="text-sm opacity-90">–±–æ–Ω—É—Å–æ–≤</div>
          </div>
        </div>
        
        {/* Progress to next level */}
        {level !== 'Platinum' && (
          <div className="mt-4">
            <div className="flex justify-between text-sm mb-1 opacity-90">
              <span>–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è</span>
              <span>{stats?.nextLevelProgress}%</span>
            </div>
            <div className="h-2 bg-white/30 rounded-full overflow-hidden">
              <div 
                className="h-full bg-white rounded-full transition-all"
                style={{ width: `${stats?.nextLevelProgress}%` }}
              />
            </div>
          </div>
        )}
      </div>

      {/* Stats Grid */}
      <div className="grid gap-6 md:grid-cols-4 mb-8">
        <div className="bg-white rounded-xl border p-6">
          <div className="flex items-center gap-4">
            <div className="w-12 h-12 rounded-full bg-indigo-100 flex items-center justify-center">
              <Coffee className="w-6 h-6 text-indigo-600" />
            </div>
            <div>
              <div className="text-2xl font-bold">{stats?.totalPurchases}</div>
              <div className="text-sm text-gray-500">–ü–æ–∫—É–ø–æ–∫</div>
            </div>
          </div>
        </div>

        <div className="bg-white rounded-xl border p-6">
          <div className="flex items-center gap-4">
            <div className="w-12 h-12 rounded-full bg-green-100 flex items-center justify-center">
              <TrendingUp className="w-6 h-6 text-green-600" />
            </div>
            <div>
              <div className="text-2xl font-bold">
                {formatCurrency(stats?.totalSpent || 0, { compact: true })}
              </div>
              <div className="text-sm text-gray-500">–ü–æ—Ç—Ä–∞—á–µ–Ω–æ</div>
            </div>
          </div>
        </div>

        <div className="bg-white rounded-xl border p-6">
          <div className="flex items-center gap-4">
            <div className="w-12 h-12 rounded-full bg-yellow-100 flex items-center justify-center">
              <Gift className="w-6 h-6 text-yellow-600" />
            </div>
            <div>
              <div className="text-2xl font-bold">{stats?.bonusPoints?.toLocaleString()}</div>
              <div className="text-sm text-gray-500">–ë–æ–Ω—É—Å–æ–≤</div>
            </div>
          </div>
        </div>

        <div className="bg-white rounded-xl border p-6">
          <div className="flex items-center gap-4">
            <div className="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center">
              <Heart className="w-6 h-6 text-red-600" />
            </div>
            <div>
              <div className="text-lg font-bold truncate">{stats?.favoriteDrink || '‚Äî'}</div>
              <div className="text-sm text-gray-500">–õ—é–±–∏–º—ã–π –Ω–∞–ø–∏—Ç–æ–∫</div>
            </div>
          </div>
        </div>
      </div>

      {/* Quick Actions */}
      <h2 className="text-xl font-semibold mb-4">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
      <div className="grid gap-4 md:grid-cols-3">
        <Link href="/my/history" className="group bg-white rounded-xl border p-6 hover:shadow-lg transition">
          <History className="w-8 h-8 text-gray-400 group-hover:text-indigo-600 mb-4 transition" />
          <h3 className="font-semibold mb-1">–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫</h3>
          <p className="text-sm text-gray-500">–í—Å–µ –≤–∞—à–∏ –ø–æ–∫—É–ø–∫–∏ –∏ —á–µ–∫–∏</p>
        </Link>

        <Link href="/my/bonuses" className="group bg-white rounded-xl border p-6 hover:shadow-lg transition">
          <Gift className="w-8 h-8 text-gray-400 group-hover:text-yellow-500 mb-4 transition" />
          <h3 className="font-semibold mb-1">–ë–æ–Ω—É—Å—ã –∏ –∞–∫—Ü–∏–∏</h3>
          <p className="text-sm text-gray-500">–û–±–º–µ–Ω—è—Ç—å –±–∞–ª–ª—ã –Ω–∞ —Å–∫–∏–¥–∫–∏</p>
        </Link>

        <Link href="/locations" className="group bg-white rounded-xl border p-6 hover:shadow-lg transition">
          <Coffee className="w-8 h-8 text-gray-400 group-hover:text-green-600 mb-4 transition" />
          <h3 className="font-semibold mb-1">–ù–∞–π—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç</h3>
          <p className="text-sm text-gray-500">–ë–ª–∏–∂–∞–π—à–∏–µ —Ç–æ—á–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–µ</p>
        </Link>
      </div>
    </div>
  );
}
```

---

## 7. SPRINT 3: TELEGRAM –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø (–ù–µ–¥–µ–ª—è 3, 8 —á–∞—Å–æ–≤)

### 7.1 –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

#### –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤
```
/start      ‚Äî –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –ø—Ä–∏–≤—è–∑–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞
/menu       ‚Äî –ú–µ–Ω—é –Ω–∞–ø–∏—Ç–∫–æ–≤
/locations  ‚Äî –ë–ª–∏–∂–∞–π—à–∏–µ –∞–≤—Ç–æ–º–∞—Ç—ã
/balance    ‚Äî –ë–∞–ª–∞–Ω—Å –±–æ–Ω—É—Å–æ–≤
/history    ‚Äî –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 10)
/promo      ‚Äî –¢–µ–∫—É—â–∏–µ –∞–∫—Ü–∏–∏
/support    ‚Äî –°–≤—è–∑—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
```

#### –î–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
```
/tasks      ‚Äî –ú–æ–∏ –∑–∞–¥–∞—á–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
/task_done [id] ‚Äî –û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
/report     ‚Äî –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ-–æ—Ç—á—ë—Ç
/incident   ‚Äî –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ü–∏–¥–µ–Ω—Ç
/stock [–º–∞—à–∏–Ω–∞] ‚Äî –û—Å—Ç–∞—Ç–∫–∏ –≤ –∞–≤—Ç–æ–º–∞—Ç–µ
/collect    ‚Äî –ù–∞—á–∞—Ç—å –∏–Ω–∫–∞—Å—Å–∞—Ü–∏—é
```

#### –î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
```
/stats      ‚Äî –°–≤–æ–¥–∫–∞ –∑–∞ –¥–µ–Ω—å
/alerts     ‚Äî –ê–∫—Ç–∏–≤–Ω—ã–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è
/staff      ‚Äî –°—Ç–∞—Ç—É—Å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
```

### 7.2 –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

```typescript
// Backend: telegram-notifications.service.ts

export enum NotificationType {
  // –ö–ª–∏–µ–Ω—Ç–∞–º
  PURCHASE_COMPLETE = 'purchase_complete',
  BONUS_EARNED = 'bonus_earned',
  PROMO_NEW = 'promo_new',
  
  // –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º
  TASK_ASSIGNED = 'task_assigned',
  TASK_REMINDER = 'task_reminder',
  LOW_STOCK_ALERT = 'low_stock',
  
  // –ú–µ–Ω–µ–¥–∂–µ—Ä–∞–º
  DAILY_REPORT = 'daily_report',
  TASK_OVERDUE = 'task_overdue',
  INCIDENT_CREATED = 'incident_created',
}

const TEMPLATES = {
  [NotificationType.PURCHASE_COMPLETE]: (data) => `
‚òï –ü–æ–∫—É–ø–∫–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–∞!

${data.productName}
üí∞ ${formatCurrency(data.amount)}
üéÅ +${data.bonusEarned} –±–æ–Ω—É—Å–æ–≤

–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –≤—ã–±–∏—Ä–∞–µ—Ç–µ VendHub!
  `,
  
  [NotificationType.TASK_ASSIGNED]: (data) => `
üìã –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞!

${data.taskType}: ${data.machineName}
üìç ${data.location}
‚è∞ –î–æ ${data.deadline}

/task_done_${data.taskId} ‚Äî –æ—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
  `,
  
  [NotificationType.LOW_STOCK_ALERT]: (data) => `
‚ö†Ô∏è –ù–∏–∑–∫–∏–π –æ—Å—Ç–∞—Ç–æ–∫!

–ê–ø–ø–∞—Ä–∞—Ç: ${data.machineName}
üìç ${data.location}
–¢–æ–≤–∞—Ä: ${data.productName}
–û—Å—Ç–∞—Ç–æ–∫: ${data.quantity} —à—Ç.

–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ.
  `,
};
```

---

## 8. SPRINT 4: –§–†–ê–ù–ß–ê–ô–ó–ò–ù–ì (–ù–µ–¥–µ–ª—è 4, 16 —á–∞—Å–æ–≤)

### 8.1 Multi-tenant –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```sql
-- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
CREATE TABLE organizations (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(255) NOT NULL,
  slug VARCHAR(100) UNIQUE NOT NULL,
  type VARCHAR(50) DEFAULT 'franchise', -- 'main' | 'franchise'
  parent_id UUID REFERENCES organizations(id),
  settings JSONB DEFAULT '{}',
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- –î–æ–±–∞–≤–∏—Ç—å organization_id –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ç–∞–±–ª–∏—Ü–∞–º
ALTER TABLE machines ADD COLUMN organization_id UUID REFERENCES organizations(id);
ALTER TABLE users ADD COLUMN organization_id UUID REFERENCES organizations(id);
ALTER TABLE transactions ADD COLUMN organization_id UUID REFERENCES organizations(id);
ALTER TABLE tasks ADD COLUMN organization_id UUID REFERENCES organizations(id);

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
CREATE INDEX idx_machines_org ON machines(organization_id);
CREATE INDEX idx_users_org ON users(organization_id);
CREATE INDEX idx_transactions_org ON transactions(organization_id);
```

### 8.2 –ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

```typescript
// Middleware –¥–ª—è tenant isolation
@Injectable()
export class TenantMiddleware implements NestMiddleware {
  use(req: Request, res: Response, next: NextFunction) {
    const user = req.user;
    
    if (!user) {
      return next();
    }
    
    // Owner/Admin –≤–∏–¥—è—Ç –≤—Å—ë
    if (user.role === UserRole.OWNER && !user.organization_id) {
      req.tenantFilter = {};
      return next();
    }
    
    // –§—Ä–∞–Ω—á–∞–π–∑–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é
    if (user.organization_id) {
      req.tenantFilter = { organization_id: user.organization_id };
    }
    
    next();
  }
}

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö
@Injectable()
export class MachinesService {
  async findAll(user: User, filters: MachineFilters) {
    const query = this.machineRepo.createQueryBuilder('machine');
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º tenant filter
    if (user.organization_id) {
      query.andWhere('machine.organization_id = :orgId', { 
        orgId: user.organization_id 
      });
    }
    
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
    
    return query.getMany();
  }
}
```

---

## 9. ROADMAP

### –í–∏–∑—É–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞

```
2025
‚îú‚îÄ‚îÄ –Ø–Ω–≤–∞—Ä—å (Sprint 0-1)
‚îÇ   ‚îú‚îÄ‚îÄ ‚úÖ Fix Roles & Currency
‚îÇ   ‚îú‚îÄ‚îÄ ‚úÖ Collapsible Sidebar
‚îÇ   ‚îú‚îÄ‚îÄ ‚úÖ Export Button
‚îÇ   ‚îî‚îÄ‚îÄ ‚úÖ Product Tour
‚îÇ
‚îú‚îÄ‚îÄ –§–µ–≤—Ä–∞–ª—å (Sprint 2)
‚îÇ   ‚îú‚îÄ‚îÄ üîÑ Customer Cabinet
‚îÇ   ‚îú‚îÄ‚îÄ üîÑ Bonus System
‚îÇ   ‚îú‚îÄ‚îÄ üîÑ Purchase History
‚îÇ   ‚îî‚îÄ‚îÄ üîÑ Public API
‚îÇ
‚îú‚îÄ‚îÄ –ú–∞—Ä—Ç (Sprint 3)
‚îÇ   ‚îú‚îÄ‚îÄ üìã Telegram Bot v2
‚îÇ   ‚îú‚îÄ‚îÄ üìã Push Notifications
‚îÇ   ‚îú‚îÄ‚îÄ üìã PWA Improvements
‚îÇ   ‚îî‚îÄ‚îÄ üìã Mobile Optimizations
‚îÇ
‚îî‚îÄ‚îÄ –ê–ø—Ä–µ–ª—å (Sprint 4)
    ‚îú‚îÄ‚îÄ üìã Multi-tenant Schema
    ‚îú‚îÄ‚îÄ üìã Franchise Dashboard
    ‚îú‚îÄ‚îÄ üìã Analytics per Org
    ‚îî‚îÄ‚îÄ üìã White-label Options
```

### –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏

| Sprint | –û–ø–∏—Å–∞–Ω–∏–µ | –ß–∞—Å—ã | –°—Ç–∞—Ç—É—Å |
|--------|----------|------|--------|
| **Sprint 0** | Blockers (Roles, Currency) | 3—á | üî¥ TODO |
| **Sprint 1** | Office UX | 11—á | üî¥ TODO |
| **Sprint 2** | Customer Zone | 12—á | üî¥ TODO |
| **Sprint 3** | Telegram v2 | 8—á | üî¥ TODO |
| **Sprint 4** | Franchise | 16—á | üî¥ TODO |
| **–ò–¢–û–ì–û** | | **50—á** | |

---

## üìã –ß–ï–ö–õ–ò–°–¢ –í–ù–ï–î–†–ï–ù–ò–Ø

### Sprint 0 (–î–µ–Ω—å 1)
```
‚ñ° Backup —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞
‚ñ° –û–±–Ω–æ–≤–∏—Ç—å frontend/src/types/users.ts
‚ñ° –û–±–Ω–æ–≤–∏—Ç—å frontend/src/lib/utils.ts (currency)
‚ñ° –ü–æ–∏—Å–∫ –∏ –∑–∞–º–µ–Ω–∞ ‚ÇΩ ‚Üí —Å—É–º
‚ñ° npm run build - –±–µ–∑ –æ—à–∏–±–æ–∫
‚ñ° –¢–µ—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö —Ä–æ–ª–µ–π
```

### Sprint 1 (–ù–µ–¥–µ–ª—è 1)
```
‚ñ° –ó–∞–º–µ–Ω–∏—Ç—å Sidebar.tsx
‚ñ° –°–æ–∑–¥–∞—Ç—å ExportButton.tsx
‚ñ° npm install xlsx
‚ñ° –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: machines, transactions, tasks
‚ñ° –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```

### Sprint 2 (–ù–µ–¥–µ–ª—è 2)
```
‚ñ° –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É /my/* —Å—Ç—Ä–∞–Ω–∏—Ü
‚ñ° –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Customer Dashboard
‚ñ° Backend API –¥–ª—è customer stats
‚ñ° –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
‚ñ° –ë–æ–Ω—É—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ)
```

### Sprint 3 (–ù–µ–¥–µ–ª—è 3)
```
‚ñ° –†–∞—Å—à–∏—Ä–∏—Ç—å Telegram –±–æ—Ç–∞
‚ñ° –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤
‚ñ° –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚ñ° –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ end-to-end
```

### Sprint 4 (–ù–µ–¥–µ–ª—è 4)
```
‚ñ° –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î –¥–ª—è organizations
‚ñ° Tenant middleware
‚ñ° UI –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
‚ñ° –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
```

---

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

| –ú–µ—Ç—Ä–∏–∫–∞ | –°–µ–π—á–∞—Å | –ü–æ—Å–ª–µ Sprint 4 |
|---------|--------|----------------|
| **Office UX Score** | 75/100 | 90/100 |
| **Customer Experience** | 0/100 | 80/100 |
| **Telegram Coverage** | 70% | 95% |
| **Franchise Ready** | ‚ùå | ‚úÖ |
| **Mobile PWA** | Basic | Full |

---

> **VendHub ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–æ—Ñ—Ç, —ç—Ç–æ —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –¥–µ–ª–∞–µ—Ç –≤–µ–Ω–¥–∏–Ω–≥ —É–¥–æ–±–Ω—ã–º –¥–ª—è –≤—Å–µ—Ö.**

**Ready to build! üöÄ**
