# üéØ VHM24 MASTER OPTIMIZATION PLAN

**–ï–¥–∏–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø–ª–∞–Ω –¥–æ—Ä–∞–±–æ—Ç–æ–∫ VendHub Manager 2024**

**–í–µ—Ä—Å–∏—è:** 1.1  
**–î–∞—Ç–∞:** 23 –¥–µ–∫–∞–±—Ä—è 2025  
**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/jamsmac/VHM24 (–∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã)  
**–û—Å–Ω–æ–≤–∞–Ω –Ω–∞:** UI/UX Audit 75/100, Technical Audit 82/100

---

> **VHM24** ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π. –í—Å–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –∏–¥—É—Ç —Å—é–¥–∞.
> 
> –î–æ–Ω–æ—Ä—Å–∫–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (VendHub, vendhub-showcase, vendify-menu-maps, vendhub-bot) ‚Äî 
> –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –Ω–∞—Ä–∞–±–æ—Ç–∫–∏, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –±–µ—Ä—ë–º –ø–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤ VHM24.

---

## üìã –°–û–î–ï–†–ñ–ê–ù–ò–ï

1. [–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ](#1-–≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ-—Ç–µ–∫—É—â–µ–µ-—Å–æ—Å—Ç–æ—è–Ω–∏–µ)
2. [Sprint 0: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ (BLOCKER)](#2-sprint-0-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-–±–∞–≥–∏)
3. [Sprint 1: Office UX](#3-sprint-1-office-ux)
4. [Sprint 2: –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –∑–æ–Ω–∞](#4-sprint-2-–∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è-–∑–æ–Ω–∞)
5. [Sprint 3: Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è](#5-sprint-3-telegram-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
6. [Sprint 4: Franchise System](#6-sprint-4-franchise-system)
7. [–î–æ–Ω–æ—Ä—Å–∫–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏](#7-–¥–æ–Ω–æ—Ä—Å–∫–∏–µ-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏)
8. [Roadmap –∏ –æ—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏](#8-roadmap-–∏-–æ—Ü–µ–Ω–∫–∞-–≤—Ä–µ–º–µ–Ω–∏)
9. [–ß–µ–∫–ª–∏—Å—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è](#9-—á–µ–∫–ª–∏—Å—Ç-–≤–Ω–µ–¥—Ä–µ–Ω–∏—è)

---

## 1. –í–ï–†–ò–§–ò–¶–ò–†–û–í–ê–ù–ù–û–ï –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï

### 1.1 –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫ (–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ)

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –í–µ—Ä—Å–∏—è | –°—Ç–∞—Ç—É—Å |
|-----------|--------|--------|
| **Next.js** | 16.1.0 | ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ |
| **React** | 19.2.3 | ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ |
| **NestJS** | 10.x | ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ |
| **TypeORM** | + PostgreSQL | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **Tailwind CSS** | 3.4.19 | ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ |
| **React Query** | 5.90.12 | ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ |
| **Zustand** | 5.0.9 | ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ |
| **Recharts** | 3.6.0 | ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ |

### 1.2 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ)

```
VHM24/
‚îú‚îÄ‚îÄ backend/              # 11M - NestJS API
‚îÇ   ‚îî‚îÄ‚îÄ src/modules/      # 28 entities, 220+ endpoints
‚îú‚îÄ‚îÄ frontend/             # 4.2M - Next.js Dashboard  
‚îÇ   ‚îú‚îÄ‚îÄ src/app/          # 87 —Å—Ç—Ä–∞–Ω–∏—Ü dashboard
‚îÇ   ‚îú‚îÄ‚îÄ src/components/   # 30+ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ src/lib/          # 50+ API —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ src/hooks/        # 8 —Ö—É–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ src/types/        # 14 —Ñ–∞–π–ª–æ–≤ —Ç–∏–ø–æ–≤
‚îú‚îÄ‚îÄ mobile/               # 918K - React Native + Expo
‚îú‚îÄ‚îÄ docs/                 # 4.3M - 90+ —Ñ–∞–π–ª–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ monitoring/           # 101K - Prometheus + Grafana
```

### 1.3 –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ)

| –ü—Ä–æ–±–ª–µ–º–∞ | –õ–æ–∫–∞—Ü–∏—è | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|----------|---------|-------------|
| **Role Mismatch** | `frontend/src/types/users.ts` vs `backend/.../user.entity.ts` | üî¥ BLOCKER |
| **Currency RUB‚ÜíUZS** | `frontend/src/lib/utils.ts:26-31` | üî¥ BLOCKER |
| **Sidebar 25 items** | `frontend/src/components/layout/Sidebar.tsx:34-60` | üü† HIGH |
| **No Excel Export** | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | üü° MEDIUM |
| **No Product Tour** | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | üü° MEDIUM |
| **No Customer Cabinet** | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | üü° MEDIUM |

### 1.4 –ü–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- 2FA –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (TOTP)
- Setup Wizard (–ø–µ—Ä–≤–∏—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- Command Palette (Ctrl+K –ø–æ–∏—Å–∫)
- –°–∏—Å—Ç–µ–º–∞ –∑–∞–¥–∞—á
- QR –∂–∞–ª–æ–±—ã
- Telegram –º–æ–¥—É–ª—å (–±–∞–∑–æ–≤—ã–π)
- Web Push (VAPID)
- Offline —Ä–µ–∂–∏–º –≤ mobile
- 3-—É—Ä–æ–≤–Ω–µ–≤—ã–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å

‚ùå **–ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ sidebar
- –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel/CSV
- Product Tour / Onboarding
- Inline Create Select
- –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–∞–±–∏–Ω–µ—Ç (/my/*)
- –ë–æ–Ω—É—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- –§—Ä–∞–Ω—á–∞–π–∑–∏–Ω–≥ / Multi-tenant

---

## 2. SPRINT 0: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ë–ê–ì–ò

**–°—Ä–æ–∫:** –î–µ–Ω—å 1 (3 —á–∞—Å–∞)  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ BLOCKER

### 2.1 TASK B.1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ä–æ–ª–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞:**  
- Frontend: 5 —Ä–æ–ª–µ–π (Admin, Manager, Operator, Viewer, Accountant) - PascalCase  
- Backend: 7 —Ä–æ–ª–µ–π (Owner, Admin, Manager, Operator, Collector, Technician, Viewer) - PascalCase  
- –ù–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ: Frontend –Ω–µ—Ç Owner, Collector, Technician; Backend –Ω–µ—Ç Accountant

**–§–∞–π–ª –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** `frontend/src/types/users.ts`

**–ü–æ–ª–Ω—ã–π –∫–æ–¥ –∑–∞–º–µ–Ω—ã:**

```typescript
// frontend/src/types/users.ts - –ü–û–õ–ù–ê–Ø –ó–ê–ú–ï–ù–ê

export enum UserRole {
  OWNER = 'Owner',
  ADMIN = 'Admin',
  MANAGER = 'Manager',
  OPERATOR = 'Operator',
  COLLECTOR = 'Collector',
  TECHNICIAN = 'Technician',
  VIEWER = 'Viewer',
}

export const ROLE_CONFIG: Record<UserRole, {
  label: string;
  labelRu: string;
  icon: string;
  color: string;
  bgClass: string;
  textClass: string;
  description: string;
}> = {
  [UserRole.OWNER]: {
    label: 'Owner',
    labelRu: '–í–ª–∞–¥–µ–ª–µ—Ü',
    icon: 'üëë',
    color: 'purple',
    bgClass: 'bg-purple-100 dark:bg-purple-900/30',
    textClass: 'text-purple-800 dark:text-purple-400',
    description: '–í–ª–∞–¥–µ–ª–µ—Ü –±–∏–∑–Ω–µ—Å–∞',
  },
  [UserRole.ADMIN]: {
    label: 'Admin',
    labelRu: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
    icon: '‚öôÔ∏è',
    color: 'red',
    bgClass: 'bg-red-100 dark:bg-red-900/30',
    textClass: 'text-red-800 dark:text-red-400',
    description: '–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ',
  },
  [UserRole.MANAGER]: {
    label: 'Manager',
    labelRu: '–ú–µ–Ω–µ–¥–∂–µ—Ä',
    icon: 'üìä',
    color: 'blue',
    bgClass: 'bg-blue-100 dark:bg-blue-900/30',
    textClass: 'text-blue-800 dark:text-blue-400',
    description: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏',
  },
  [UserRole.OPERATOR]: {
    label: 'Operator',
    labelRu: '–û–ø–µ—Ä–∞—Ç–æ—Ä',
    icon: 'üîß',
    color: 'green',
    bgClass: 'bg-green-100 dark:bg-green-900/30',
    textClass: 'text-green-800 dark:text-green-400',
    description: '–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–æ–≤',
  },
  [UserRole.COLLECTOR]: {
    label: 'Collector',
    labelRu: '–ò–Ω–∫–∞—Å—Å–∞—Ç–æ—Ä',
    icon: 'üí∞',
    color: 'yellow',
    bgClass: 'bg-yellow-100 dark:bg-yellow-900/30',
    textClass: 'text-yellow-800 dark:text-yellow-400',
    description: '–°–±–æ—Ä –Ω–∞–ª–∏—á–Ω—ã—Ö',
  },
  [UserRole.TECHNICIAN]: {
    label: 'Technician',
    labelRu: '–¢–µ—Ö–Ω–∏–∫',
    icon: 'üõ†Ô∏è',
    color: 'orange',
    bgClass: 'bg-orange-100 dark:bg-orange-900/30',
    textClass: 'text-orange-800 dark:text-orange-400',
    description: '–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ —Ä–µ–º–æ–Ω—Ç',
  },
  [UserRole.VIEWER]: {
    label: 'Viewer',
    labelRu: '–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å',
    icon: 'üëÅÔ∏è',
    color: 'gray',
    bgClass: 'bg-gray-100 dark:bg-gray-900/30',
    textClass: 'text-gray-800 dark:text-gray-400',
    description: '–¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä',
  },
};

export function getRoleConfig(role: UserRole | string) {
  return ROLE_CONFIG[role as UserRole] || ROLE_CONFIG[UserRole.VIEWER];
}

export interface User {
  id: string;
  email: string;
  username?: string;
  full_name: string;
  role: UserRole;
  phone?: string;
  is_active: boolean;
  status?: 'pending' | 'active' | 'password_change_required' | 'inactive' | 'suspended' | 'rejected';
  is_2fa_enabled?: boolean;
  telegram_user_id?: string;
  organization_id?: string;
  created_at: string;
  updated_at: string;
  last_login?: string;
  stats?: {
    total_tasks?: number;
    completed_tasks?: number;
    pending_tasks?: number;
    active_tasks?: number;
    resolved_incidents?: number;
  };
}

export interface CreateUserDto {
  email: string;
  password: string;
  full_name: string;
  role: UserRole;
  phone?: string;
  username?: string;
}

export interface UpdateUserDto {
  email?: string;
  full_name?: string;
  role?: UserRole;
  phone?: string;
  is_active?: boolean;
}
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
```bash
# –ü–æ–∏—Å–∫ –∏ –∑–∞–º–µ–Ω–∞ –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö
grep -rn "Accountant" frontend/src --include="*.tsx" --include="*.ts"
# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ Accountant

grep -rn "'admin'\|'manager'\|'operator'\|'viewer'" frontend/src --include="*.tsx" --include="*.ts"
# –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ UserRole.ADMIN, UserRole.MANAGER –∏ —Ç.–¥.
```

---

### 2.2 TASK B.2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞–ª—é—Ç—ã (RUB ‚Üí UZS)

**–ü—Ä–æ–±–ª–µ–º–∞:** –§—É–Ω–∫—Ü–∏—è `formatCurrency` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç RUB –≤–º–µ—Å—Ç–æ UZS

**–§–∞–π–ª:** `frontend/src/lib/utils.ts` (—Å—Ç—Ä–æ–∫–∏ 26-31)

**–ü–æ–ª–Ω—ã–π –∫–æ–¥ –∑–∞–º–µ–Ω—ã:**

```typescript
// frontend/src/lib/utils.ts - –ó–ê–ú–ï–ù–ê —Ñ—É–Ω–∫—Ü–∏–∏ formatCurrency

export const CURRENCY = {
  code: 'UZS',
  symbol: '—Å—û–º',
  symbolShort: '—Å—É–º',
  locale: 'uz-UZ',
} as const;

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É–º–º—ã –≤ —É–∑–±–µ–∫—Å–∫–∏—Ö —Å—É–º–∞—Ö
 * @example formatCurrency(1500000) ‚Üí "1 500 000 —Å—É–º"
 * @example formatCurrency(1500000, { compact: true }) ‚Üí "1.5 –º–ª–Ω"
 */
export function formatCurrency(
  amount: number | null | undefined,
  options?: {
    showSymbol?: boolean;
    compact?: boolean;
    decimals?: number;
  }
): string {
  if (amount === null || amount === undefined) return '‚Äî';
  
  const { showSymbol = true, compact = false, decimals = 0 } = options || {};
  
  let formatted: string;
  
  if (compact) {
    const abs = Math.abs(amount);
    if (abs >= 1_000_000_000) {
      formatted = (amount / 1_000_000_000).toFixed(1).replace('.0', '') + ' –º–ª—Ä–¥';
    } else if (abs >= 1_000_000) {
      formatted = (amount / 1_000_000).toFixed(1).replace('.0', '') + ' –º–ª–Ω';
    } else if (abs >= 1_000) {
      formatted = (amount / 1_000).toFixed(1).replace('.0', '') + ' —Ç—ã—Å';
    } else {
      formatted = amount.toFixed(decimals);
    }
  } else {
    formatted = new Intl.NumberFormat('ru-RU', {
      minimumFractionDigits: decimals,
      maximumFractionDigits: decimals,
    }).format(amount);
  }
  
  return showSymbol ? `${formatted} ${CURRENCY.symbolShort}` : formatted;
}

/**
 * –ö–æ—Ä–æ—Ç–∫–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –æ—Å–µ–π –≥—Ä–∞—Ñ–∏–∫–æ–≤
 */
export function formatCurrencyShort(amount: number): string {
  if (amount >= 1_000_000_000) return (amount / 1_000_000_000).toFixed(1) + 'B';
  if (amount >= 1_000_000) return (amount / 1_000_000).toFixed(1) + 'M';
  if (amount >= 1_000) return (amount / 1_000).toFixed(0) + 'K';
  return amount.toString();
}
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
```bash
# –ü–æ–∏—Å–∫ –≤—Å–µ—Ö —É–ø–æ–º–∏–Ω–∞–Ω–∏–π RUB –∏ ‚ÇΩ
grep -rn "‚ÇΩ\|RUB\|—Ä—É–±\." frontend/src --include="*.tsx" --include="*.ts"

# –ó–∞–º–µ–Ω—ã:
# ‚ÇΩ ‚Üí —Å—É–º
# RUB ‚Üí UZS
# '—Ä—É–±.' ‚Üí '—Å—É–º'
```

---

## 3. SPRINT 1: OFFICE UX

**–°—Ä–æ–∫:** –ù–µ–¥–µ–ª—è 1 (11 —á–∞—Å–æ–≤)  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü† HIGH

### 3.1 TASK 1.1: Collapsible Sidebar —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π (3—á)

**–§–∞–π–ª:** `frontend/src/components/layout/Sidebar.tsx` - –ü–û–õ–ù–ê–Ø –ó–ê–ú–ï–ù–ê

**–ì—Ä—É–ø–ø—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:**
```
üìä –û–±–∑–æ—Ä
   ‚îî‚îÄ Dashboard

‚òï –ê–≤—Ç–æ–º–∞—Ç—ã
   ‚îú‚îÄ –°–ø–∏—Å–æ–∫ –º–∞—à–∏–Ω
   ‚îú‚îÄ –î–æ—Å—Ç—É–ø
   ‚îú‚îÄ –ö–∞—Ä—Ç–∞
   ‚îî‚îÄ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

üìã –û–ø–µ—Ä–∞—Ü–∏–∏
   ‚îú‚îÄ –ó–∞–¥–∞—á–∏
   ‚îú‚îÄ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ
   ‚îú‚îÄ –ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã
   ‚îî‚îÄ –ñ–∞–ª–æ–±—ã

üì¶ –°–∫–ª–∞–¥
   ‚îú‚îÄ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
   ‚îú‚îÄ –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
   ‚îî‚îÄ –ò–º–ø–æ—Ä—Ç

üí∞ –§–∏–Ω–∞–Ω—Å—ã
   ‚îú‚îÄ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
   ‚îú‚îÄ –ö–æ–º–∏—Å—Å–∏–∏
   ‚îú‚îÄ –î–æ–≥–æ–≤–æ—Ä—ã
   ‚îú‚îÄ –ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—ã
   ‚îî‚îÄ –û—Ç—á—ë—Ç—ã

üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   ‚îú‚îÄ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   ‚îî‚îÄ –û–ø–æ–≤–µ—â–µ–Ω–∏—è

‚öôÔ∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
   ‚îú‚îÄ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
   ‚îú‚îÄ –õ–æ–∫–∞—Ü–∏–∏
   ‚îú‚îÄ Telegram
   ‚îú‚îÄ –ê—É–¥–∏—Ç
   ‚îú‚îÄ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
   ‚îî‚îÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∏
```

**–ü–æ–ª–Ω—ã–π –∫–æ–¥:**

```typescript
'use client'

import { useState, useEffect } from 'react'
import Link from 'next/link'
import { usePathname } from 'next/navigation'
import {
  LayoutDashboard, Package, ClipboardList, AlertTriangle,
  MessageSquare, DollarSign, Users, MapPin, Map, Settings,
  Shield, Bell, BellRing, BarChart3, Wrench, Send, Building2,
  FileText, Receipt, FileUp, Activity, ScrollText, Timer,
  KeyRound, ChevronDown, ChevronRight, Coffee, ExternalLink,
} from 'lucide-react'
import { cn } from '@/lib/utils'
import { useActiveAlertsCount } from '@/hooks/useActiveAlertsCount'

const NAVIGATION_GROUPS = [
  {
    id: 'overview',
    label: '–û–±–∑–æ—Ä',
    icon: LayoutDashboard,
    defaultOpen: true,
    items: [
      { name: 'Dashboard', href: '/dashboard', icon: LayoutDashboard },
    ]
  },
  {
    id: 'machines',
    label: '–ê–≤—Ç–æ–º–∞—Ç—ã',
    icon: Coffee,
    defaultOpen: true,
    items: [
      { name: '–í—Å–µ –∞–ø–ø–∞—Ä–∞—Ç—ã', href: '/dashboard/machines', icon: Package },
      { name: '–î–æ—Å—Ç—É–ø', href: '/dashboard/machines/access', icon: KeyRound },
      { name: '–ö–∞—Ä—Ç–∞', href: '/dashboard/map', icon: Map },
      { name: '–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥', href: '/dashboard/monitoring', icon: Activity },
    ]
  },
  {
    id: 'operations',
    label: '–û–ø–µ—Ä–∞—Ü–∏–∏',
    icon: ClipboardList,
    defaultOpen: true,
    items: [
      { name: '–ó–∞–¥–∞—á–∏', href: '/dashboard/tasks', icon: ClipboardList },
      { name: '–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ', href: '/dashboard/scheduled-tasks', icon: Timer },
      { name: '–ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã', href: '/dashboard/incidents', icon: AlertTriangle },
      { name: '–ñ–∞–ª–æ–±—ã', href: '/dashboard/complaints', icon: MessageSquare },
    ]
  },
  {
    id: 'inventory',
    label: '–°–∫–ª–∞–¥',
    icon: Wrench,
    items: [
      { name: '–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å', href: '/dashboard/inventory', icon: Package },
      { name: '–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ', href: '/dashboard/equipment', icon: Wrench },
      { name: '–ò–º–ø–æ—Ä—Ç', href: '/dashboard/import', icon: FileUp },
    ]
  },
  {
    id: 'finance',
    label: '–§–∏–Ω–∞–Ω—Å—ã',
    icon: DollarSign,
    items: [
      { name: '–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏', href: '/dashboard/transactions', icon: DollarSign },
      { name: '–ö–æ–º–∏—Å—Å–∏–∏', href: '/dashboard/commissions', icon: Receipt },
      { name: '–î–æ–≥–æ–≤–æ—Ä—ã', href: '/dashboard/contracts', icon: FileText },
      { name: '–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—ã', href: '/dashboard/counterparties', icon: Building2 },
      { name: '–û—Ç—á—ë—Ç—ã', href: '/dashboard/reports', icon: BarChart3 },
    ]
  },
  {
    id: 'notifications',
    label: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è',
    icon: Bell,
    items: [
      { name: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è', href: '/dashboard/notifications', icon: Bell },
      { name: '–û–ø–æ–≤–µ—â–µ–Ω–∏—è', href: '/dashboard/alerts', icon: BellRing, badge: true },
    ]
  },
  {
    id: 'admin',
    label: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ',
    icon: Settings,
    items: [
      { name: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏', href: '/dashboard/users', icon: Users },
      { name: '–õ–æ–∫–∞—Ü–∏–∏', href: '/dashboard/locations', icon: MapPin },
      { name: 'Telegram', href: '/dashboard/telegram', icon: Send },
      { name: '–ê—É–¥–∏—Ç', href: '/dashboard/audit', icon: ScrollText },
      { name: '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', href: '/dashboard/security', icon: Shield },
      { name: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏', href: '/dashboard/settings', icon: Settings },
    ]
  },
]

function useLocalStorage<T>(key: string, initial: T): [T, (v: T) => void] {
  const [value, setValue] = useState<T>(initial)
  
  useEffect(() => {
    try {
      const stored = localStorage.getItem(key)
      if (stored) setValue(JSON.parse(stored))
    } catch {}
  }, [key])
  
  const set = (v: T) => {
    setValue(v)
    try { localStorage.setItem(key, JSON.stringify(v)) } catch {}
  }
  
  return [value, set]
}

function AlertsBadge() {
  const { count } = useActiveAlertsCount()
  if (!count) return null
  return (
    <span className="ml-auto px-2 py-0.5 text-xs font-medium rounded-full bg-red-100 text-red-700">
      {count > 99 ? '99+' : count}
    </span>
  )
}

export function Sidebar() {
  const pathname = usePathname()
  const [expanded, setExpanded] = useLocalStorage<string[]>(
    'vhm24-nav-expanded',
    NAVIGATION_GROUPS.filter(g => g.defaultOpen).map(g => g.id)
  )

  useEffect(() => {
    const activeGroup = NAVIGATION_GROUPS.find(g =>
      g.items.some(i => pathname === i.href || pathname?.startsWith(i.href + '/'))
    )
    if (activeGroup && !expanded.includes(activeGroup.id)) {
      setExpanded([...expanded, activeGroup.id])
    }
  }, [pathname])

  const toggle = (id: string) => {
    setExpanded(expanded.includes(id) 
      ? expanded.filter(x => x !== id) 
      : [...expanded, id])
  }

  const isActive = (href: string) => pathname === href || pathname?.startsWith(href + '/')

  return (
    <aside className="hidden md:flex flex-col w-64 bg-white dark:bg-slate-900 border-r border-gray-200 dark:border-slate-800 h-screen" data-tour="sidebar">
      {/* Logo */}
      <div className="p-4 border-b border-gray-100 dark:border-slate-800">
        <Link href="/dashboard" className="flex items-center gap-3">
          <div className="w-10 h-10 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-xl flex items-center justify-center">
            <Coffee className="w-5 h-5 text-white" />
          </div>
          <div>
            <div className="font-bold text-gray-900 dark:text-white">VendHub</div>
            <div className="text-xs text-gray-500 dark:text-gray-400">Manager</div>
          </div>
        </Link>
      </div>

      {/* Navigation */}
      <nav className="flex-1 overflow-y-auto p-3">
        {NAVIGATION_GROUPS.map((group) => {
          const isOpen = expanded.includes(group.id)
          const hasActive = group.items.some(i => isActive(i.href))
          const Icon = group.icon

          return (
            <div key={group.id} className="mb-1">
              <button
                onClick={() => toggle(group.id)}
                className={cn(
                  'w-full flex items-center justify-between px-3 py-2 text-sm font-medium rounded-lg transition',
                  hasActive 
                    ? 'bg-indigo-50 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-400' 
                    : 'text-gray-600 hover:bg-gray-50 dark:text-gray-400 dark:hover:bg-slate-800'
                )}
              >
                <span className="flex items-center gap-3">
                  <Icon className="w-5 h-5" />
                  {group.label}
                </span>
                {isOpen ? <ChevronDown className="w-4 h-4" /> : <ChevronRight className="w-4 h-4" />}
              </button>

              <div className={cn(
                'overflow-hidden transition-all duration-200',
                isOpen ? 'max-h-96 opacity-100' : 'max-h-0 opacity-0'
              )}>
                <ul className="mt-1 ml-4 pl-3 border-l-2 border-gray-100 dark:border-slate-700 space-y-0.5">
                  {group.items.map((item) => {
                    const ItemIcon = item.icon
                    const active = isActive(item.href)
                    
                    return (
                      <li key={item.href}>
                        <Link
                          href={item.href}
                          data-tour={item.name.toLowerCase().replace(/\s+/g, '-')}
                          className={cn(
                            'flex items-center px-3 py-2 text-sm rounded-md transition',
                            active
                              ? 'bg-indigo-100 text-indigo-700 font-medium dark:bg-indigo-900/40 dark:text-indigo-300'
                              : 'text-gray-600 hover:bg-gray-50 dark:text-gray-400 dark:hover:bg-slate-800'
                          )}
                        >
                          <ItemIcon className="mr-3 w-4 h-4" />
                          <span className="flex-1">{item.name}</span>
                          {item.badge && <AlertsBadge />}
                        </Link>
                      </li>
                    )
                  })}
                </ul>
              </div>
            </div>
          )
        })}
      </nav>

      {/* Ecosystem Links */}
      <div className="p-3 border-t border-gray-100 dark:border-slate-800 space-y-1">
        <a
          href="https://vendhub.live"
          target="_blank"
          rel="noopener"
          className="flex items-center gap-2 px-3 py-2 text-sm text-gray-500 hover:text-indigo-600 hover:bg-indigo-50 dark:hover:bg-slate-800 rounded-lg transition"
        >
          <ExternalLink className="w-4 h-4" />
          vendhub.live
        </a>
        <a
          href="https://t.me/VendHubBot"
          target="_blank"
          rel="noopener"
          className="flex items-center gap-2 px-3 py-2 text-sm text-gray-500 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-slate-800 rounded-lg transition"
        >
          <Send className="w-4 h-4" />
          @VendHubBot
        </a>
        <div className="text-xs text-gray-400 text-center pt-2">
          VendHub v2.0
        </div>
      </div>
    </aside>
  )
}

export default Sidebar
```

---

### 3.2 TASK 1.2: Excel Export Component (2—á)

**–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `frontend/src/components/ui/ExportButton.tsx`

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å:** `npm install xlsx`

```typescript
'use client'

import { useState } from 'react'
import { Download, FileSpreadsheet, FileText, ChevronDown, Loader2 } from 'lucide-react'
import { cn } from '@/lib/utils'

interface Column<T> {
  key: keyof T
  header: string
  format?: (value: any, row: T) => string
}

interface ExportButtonProps<T> {
  data: T[]
  columns: Column<T>[]
  filename: string
  className?: string
  disabled?: boolean
}

export function ExportButton<T extends Record<string, any>>({
  data,
  columns,
  filename,
  className,
  disabled = false
}: ExportButtonProps<T>) {
  const [isOpen, setIsOpen] = useState(false)
  const [isExporting, setIsExporting] = useState(false)

  const exportToCSV = async () => {
    setIsExporting(true)
    setIsOpen(false)

    try {
      const headers = columns.map(col => col.header).join(',')
      const rows = data.map(row =>
        columns.map(col => {
          const value = col.format ? col.format(row[col.key], row) : row[col.key]
          const escaped = String(value ?? '').replace(/"/g, '""')
          return escaped.includes(',') || escaped.includes('\n') 
            ? `"${escaped}"` 
            : escaped
        }).join(',')
      ).join('\n')

      const csv = `\uFEFF${headers}\n${rows}`
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8' })
      const url = URL.createObjectURL(blob)
      const a = document.createElement('a')
      a.href = url
      a.download = `${filename}-${new Date().toISOString().split('T')[0]}.csv`
      document.body.appendChild(a)
      a.click()
      document.body.removeChild(a)
      URL.revokeObjectURL(url)
    } finally {
      setIsExporting(false)
    }
  }

  const exportToExcel = async () => {
    setIsExporting(true)
    setIsOpen(false)

    try {
      const XLSX = await import('xlsx')
      const exportData = data.map(row => {
        const exportRow: Record<string, any> = {}
        columns.forEach(col => {
          exportRow[col.header] = col.format ? col.format(row[col.key], row) : row[col.key]
        })
        return exportRow
      })

      const wb = XLSX.utils.book_new()
      const ws = XLSX.utils.json_to_sheet(exportData)
      
      const colWidths = columns.map(col => ({
        wch: Math.max(
          col.header.length,
          ...exportData.map(row => String(row[col.header] || '').length)
        ) + 2
      }))
      ws['!cols'] = colWidths

      XLSX.utils.book_append_sheet(wb, ws, 'Data')
      XLSX.writeFile(wb, `${filename}-${new Date().toISOString().split('T')[0]}.xlsx`)
    } finally {
      setIsExporting(false)
    }
  }

  return (
    <div className={cn('relative', className)}>
      <button
        onClick={() => setIsOpen(!isOpen)}
        disabled={disabled || isExporting || data.length === 0}
        className={cn(
          'flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg border transition-colors',
          'bg-white border-gray-300 text-gray-700 dark:bg-slate-800 dark:border-slate-600 dark:text-gray-200',
          'hover:bg-gray-50 dark:hover:bg-slate-700',
          'disabled:opacity-50 disabled:cursor-not-allowed'
        )}
      >
        {isExporting ? (
          <Loader2 className="w-4 h-4 animate-spin" />
        ) : (
          <Download className="w-4 h-4" />
        )}
        <span>–≠–∫—Å–ø–æ—Ä—Ç</span>
        <ChevronDown className="w-4 h-4" />
      </button>

      {isOpen && (
        <>
          <div className="fixed inset-0 z-10" onClick={() => setIsOpen(false)} />
          <div className="absolute right-0 mt-2 w-48 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg shadow-lg z-20 overflow-hidden">
            <button
              onClick={exportToExcel}
              className="w-full flex items-center gap-3 px-4 py-3 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-slate-700 transition"
            >
              <FileSpreadsheet className="w-5 h-5 text-green-600" />
              <div>
                <div className="font-medium">Excel (.xlsx)</div>
                <div className="text-xs text-gray-500 dark:text-gray-400">{data.length} –∑–∞–ø–∏—Å–µ–π</div>
              </div>
            </button>
            <button
              onClick={exportToCSV}
              className="w-full flex items-center gap-3 px-4 py-3 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-slate-700 transition border-t border-gray-100 dark:border-slate-700"
            >
              <FileText className="w-5 h-5 text-blue-600" />
              <div>
                <div className="font-medium">CSV (.csv)</div>
                <div className="text-xs text-gray-500 dark:text-gray-400">{data.length} –∑–∞–ø–∏—Å–µ–π</div>
              </div>
            </button>
          </div>
        </>
      )}
    </div>
  )
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö:**

```typescript
// frontend/src/app/dashboard/machines/page.tsx
import { ExportButton } from '@/components/ui/ExportButton'
import { formatCurrency } from '@/lib/utils'

const exportColumns = [
  { key: 'name', header: '–ù–∞–∑–≤–∞–Ω–∏–µ' },
  { key: 'serialNumber', header: '–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä' },
  { key: 'location', header: '–õ–æ–∫–∞—Ü–∏—è', format: (v) => v?.name || '‚Äî' },
  { key: 'status', header: '–°—Ç–∞—Ç—É—Å' },
  { key: 'revenue', header: '–í—ã—Ä—É—á–∫–∞', format: (v) => formatCurrency(v, { showSymbol: false }) },
]

// –í JSX:
<ExportButton
  data={machines}
  columns={exportColumns}
  filename="vendhub-machines"
/>
```

---

### 3.3 TASK 1.3: InlineCreateSelect Component (3—á)

**–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `frontend/src/components/ui/InlineCreateSelect.tsx`

*(–ü–æ–ª–Ω—ã–π –∫–æ–¥ —Å–º. –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ VHM24-UI-OPTIMIZATION-PLAN.md, —Ä–∞–∑–¥–µ–ª 7)*

---

### 3.4 TASK 1.4: Product Tour Component (3—á)

**–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `frontend/src/components/onboarding/ProductTour.tsx`

*(–ü–æ–ª–Ω—ã–π –∫–æ–¥ —Å–º. –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ VHM24-UI-OPTIMIZATION-PLAN.md, —Ä–∞–∑–¥–µ–ª 3)*

**–®–∞–≥–∏ —Ç—É—Ä–∞:**
1. Sidebar –Ω–∞–≤–∏–≥–∞—Ü–∏—è
2. –ú–∞—à–∏–Ω—ã —Å–ø–∏—Å–æ–∫
3. –°–∏—Å—Ç–µ–º–∞ –∑–∞–¥–∞—á
4. –û—Ç—á—ë—Ç—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
5. –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ (Ctrl+K)

---

## 4. SPRINT 2: –ö–õ–ò–ï–ù–¢–°–ö–ê–Ø –ó–û–ù–ê

**–°—Ä–æ–∫:** –ù–µ–¥–µ–ª—è 2 (12 —á–∞—Å–æ–≤)  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° MEDIUM

### 4.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞

```
frontend/src/app/(public)/
‚îú‚îÄ‚îÄ page.tsx                  ‚úÖ Landing (–æ–±–Ω–æ–≤–∏—Ç—å)
‚îú‚îÄ‚îÄ locations/page.tsx        ‚úÖ –ö–∞—Ä—Ç–∞
‚îú‚îÄ‚îÄ menu/page.tsx             ‚úÖ –ú–µ–Ω—é
‚îú‚îÄ‚îÄ cooperation/page.tsx      ‚úÖ –ü–∞—Ä—Ç–Ω—ë—Ä—Å—Ç–≤–æ
‚îÇ
‚îú‚îÄ‚îÄ my/                       üÜï –ù–û–í–û–ï
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx              üÜï Dashboard –∫–ª–∏–µ–Ω—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ history/page.tsx      üÜï –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ bonuses/page.tsx      üÜï –ë–æ–Ω—É—Å—ã –∏ –±–∞–ª–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ favorites/page.tsx    üÜï –õ—é–±–∏–º—ã–µ –Ω–∞–ø–∏—Ç–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ settings/page.tsx     üÜï –ù–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ
‚îî‚îÄ‚îÄ promotions/page.tsx       üÜï –ê–∫—Ü–∏–∏
```

### 4.2 Backend API –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤

```typescript
// –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
GET  /api/customer/me/stats       // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞
GET  /api/customer/me/history     // –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫ (pagination)
GET  /api/customer/me/bonuses     // –ë–æ–Ω—É—Å–Ω—ã–µ –±–∞–ª–ª—ã
POST /api/customer/bonuses/redeem // –°–ø–∏—Å–∞–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤
GET  /api/customer/me/favorites   // –õ—é–±–∏–º—ã–µ –Ω–∞–ø–∏—Ç–∫–∏
```

---

## 5. SPRINT 3: TELEGRAM –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø

**–°—Ä–æ–∫:** –ù–µ–¥–µ–ª—è 3 (8 —á–∞—Å–æ–≤)  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° MEDIUM

### 5.1 –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

**–î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤:**
```
/start      ‚Äî –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
/menu       ‚Äî –ú–µ–Ω—é –Ω–∞–ø–∏—Ç–∫–æ–≤
/locations  ‚Äî –ë–ª–∏–∂–∞–π—à–∏–µ –∞–≤—Ç–æ–º–∞—Ç—ã
/balance    ‚Äî –ë–∞–ª–∞–Ω—Å –±–æ–Ω—É—Å–æ–≤
/history    ‚Äî –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫
/promo      ‚Äî –ê–∫—Ü–∏–∏
```

**–î–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:**
```
/tasks      ‚Äî –ú–æ–∏ –∑–∞–¥–∞—á–∏
/task_done [id] ‚Äî –í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞—á—É
/report     ‚Äî –§–æ—Ç–æ-–æ—Ç—á—ë—Ç
/incident   ‚Äî –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ü–∏–¥–µ–Ω—Ç
/stock [–º–∞—à–∏–Ω–∞] ‚Äî –û—Å—Ç–∞—Ç–∫–∏
```

**–î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤:**
```
/stats      ‚Äî –î–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞
/alerts     ‚Äî –ê–∫—Ç–∏–≤–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã
/staff      ‚Äî –°—Ç–∞—Ç—É—Å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
```

---

## 6. SPRINT 4: FRANCHISE SYSTEM

**–°—Ä–æ–∫:** –ù–µ–¥–µ–ª—è 4 (16 —á–∞—Å–æ–≤)  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ LOW

### 6.1 Multi-tenant —Å—Ö–µ–º–∞

```sql
CREATE TABLE organizations (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(255) NOT NULL,
  slug VARCHAR(100) UNIQUE NOT NULL,
  type VARCHAR(50) DEFAULT 'franchise',
  parent_id UUID REFERENCES organizations(id),
  settings JSONB DEFAULT '{}',
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

ALTER TABLE machines ADD COLUMN organization_id UUID REFERENCES organizations(id);
ALTER TABLE users ADD COLUMN organization_id UUID REFERENCES organizations(id);
ALTER TABLE transactions ADD COLUMN organization_id UUID REFERENCES organizations(id);

CREATE INDEX idx_machines_org ON machines(organization_id);
CREATE INDEX idx_users_org ON users(organization_id);
CREATE INDEX idx_transactions_org ON transactions(organization_id);
```

---

## 7. –î–û–ù–û–†–°–ö–ò–ï –†–ï–ü–û–ó–ò–¢–û–†–ò–ò

> **VHM24 ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã.** –í—Å–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –∏–¥—É—Ç –≤ VHM24.
> –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ ‚Äî –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –Ω–∞—Ä–∞–±–æ—Ç–∫–∏, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –±–µ—Ä—ë–º –ø–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤ VHM24.

### 7.1 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

```
üéØ VHM24 (–û–°–ù–û–í–ù–û–ô) ‚Üê –≤—Å–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ —Å—é–¥–∞
‚îÇ
‚îú‚îÄ‚îÄ üì¶ VendHub (397 commits) ‚Äî legacy backend –Ω–∞—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ –ü–æ–ª–µ–∑–Ω–æ–µ: MoneyHelper, DataParser, Reports PDF
‚îÇ
‚îú‚îÄ‚îÄ üì¶ vendhub-showcase (96 commits) ‚Äî UI –¥–µ–º–æ
‚îÇ   ‚îî‚îÄ‚îÄ –ü–æ–ª–µ–∑–Ω–æ–µ: Kanban DnD, Machine –∫–∞—Ä—Ç–æ—á–∫–∏, Recharts –ø—Ä–∏–º–µ—Ä—ã
‚îÇ
‚îú‚îÄ‚îÄ üì¶ vendify-menu-maps (83 commits) ‚Äî –ø—É–±–ª–∏—á–Ω–∞—è –∫–∞—Ä—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ –ü–æ–ª–µ–∑–Ω–æ–µ: Yandex/Google Maps –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, Menu Grid
‚îÇ
‚îî‚îÄ‚îÄ üì¶ vendhub-bot ‚Äî Telegram –±–æ—Ç
    ‚îî‚îÄ‚îÄ –ü–æ–ª–µ–∑–Ω–æ–µ: Telegram –∫–æ–º–∞–Ω–¥—ã, inline keyboards
```

### 7.2 –ß—Ç–æ –±—Ä–∞—Ç—å –∏–∑ –¥–æ–Ω–æ—Ä—Å–∫–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

**–ò–∑ VendHub (legacy backend):**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ï—Å—Ç—å –≤ VHM24? | –î–µ–π—Å—Ç–≤–∏–µ |
|-----------|---------------|----------|
| MoneyHelper (UZS —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ) | ‚ùì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å | –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –µ—Å–ª–∏ –Ω–µ—Ç |
| Data Parser Framework | ‚ùì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å | –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã |
| PDF Reports –≥–µ–Ω–µ—Ä–∞—Ü–∏—è | ‚ùì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å | –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –µ—Å–ª–∏ –Ω–µ—Ç |
| Excel Import –ª–æ–≥–∏–∫–∞ | ‚ùì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å | –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –µ—Å–ª–∏ –Ω–µ—Ç |

**–ò–∑ vendhub-showcase (UI):**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ï—Å—Ç—å –≤ VHM24? | –î–µ–π—Å—Ç–≤–∏–µ |
|-----------|---------------|----------|
| Kanban Board (@dnd-kit) | ‚ùå –ù–µ—Ç | –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è /tasks |
| Machine Map –∫–∞—Ä—Ç–æ—á–∫–∏ | ‚ùì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å | –£–ª—É—á—à–∏—Ç—å –¥–∏–∑–∞–π–Ω |
| Recharts –∫–æ–Ω—Ñ–∏–≥–∏ | –ß–∞—Å—Ç–∏—á–Ω–æ | –í–∑—è—Ç—å –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ |

**–ò–∑ vendify-menu-maps:**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ï—Å—Ç—å –≤ VHM24? | –î–µ–π—Å—Ç–≤–∏–µ |
|-----------|---------------|----------|
| Location Map (Yandex) | ‚ùì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è /locations |
| Menu Grid | ‚ùì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è /menu |
| Location Search | ‚ùì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å | –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å |

### 7.3 –ü—Ä–æ—Ü–µ—Å—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–æ–Ω–æ—Ä—Å–∫–∏–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/jamsmac/VendHub.git /tmp/VendHub

# 2. –ù–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
find /tmp/VendHub -name "*.ts" | xargs grep -l "MoneyHelper"

# 3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ VHM24 —Å –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π
cp /tmp/VendHub/src/helpers/money.helper.ts \
   VHM24/backend/src/common/helpers/

# 4. –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–º–ø–æ—Ä—Ç—ã –∏ —Ç–∏–ø—ã –ø–æ–¥ VHM24
```

### 7.4 –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü–∏—Å–∞—Ç—å —Å –Ω—É–ª—è | –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å |
|-----------|---------------|--------------|
| Kanban Board | 16—á | 3—á |
| Location Map | 12—á | 2—á |
| Menu Grid | 6—á | 1—á |
| PDF Reports | 12—á | 2—á |
| **–ò–¢–û–ì–û** | **46—á** | **8—á** |

**–≠–∫–æ–Ω–æ–º–∏—è: ~38 —á–∞—Å–æ–≤** –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ —á—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω–µ—Ç –≤ VHM24

---

## 8. ROADMAP –ò –û–¶–ï–ù–ö–ê –í–†–ï–ú–ï–ù–ò

### 8.1 –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| Sprint | –û–ø–∏—Å–∞–Ω–∏–µ | –ß–∞—Å—ã | –°—Ç–∞—Ç—É—Å |
|--------|----------|------|--------|
| **Sprint 0** | Blockers (Roles, Currency) | 3—á | üî¥ TODO |
| **Sprint 1** | Office UX (Sidebar, Export, Inline, Tour) | 11—á | üî¥ TODO |
| **Sprint 2** | Customer Zone | 12—á | üî¥ TODO |
| **Sprint 3** | Telegram v2 | 8—á | üî¥ TODO |
| **Sprint 4** | Franchise System | 16—á | üî¥ TODO |
| **–ò–¢–û–ì–û** | | **50—á** | |

### 8.2 –í–∏–∑—É–∞–ª—å–Ω—ã–π roadmap

```
2025
‚îú‚îÄ‚îÄ –Ø–Ω–≤–∞—Ä—å (Sprint 0-1)
‚îÇ   ‚îú‚îÄ‚îÄ ‚úÖ Fix Roles & Currency
‚îÇ   ‚îú‚îÄ‚îÄ ‚úÖ Collapsible Sidebar
‚îÇ   ‚îú‚îÄ‚îÄ ‚úÖ Export Button
‚îÇ   ‚îî‚îÄ‚îÄ ‚úÖ Product Tour
‚îÇ
‚îú‚îÄ‚îÄ –§–µ–≤—Ä–∞–ª—å (Sprint 2)
‚îÇ   ‚îú‚îÄ‚îÄ üîÑ Customer Cabinet
‚îÇ   ‚îú‚îÄ‚îÄ üîÑ Bonus System
‚îÇ   ‚îî‚îÄ‚îÄ üîÑ Public API
‚îÇ
‚îú‚îÄ‚îÄ –ú–∞—Ä—Ç (Sprint 3)
‚îÇ   ‚îú‚îÄ‚îÄ üìã Telegram Bot v2
‚îÇ   ‚îú‚îÄ‚îÄ üìã Push Notifications
‚îÇ   ‚îî‚îÄ‚îÄ üìã Mobile PWA
‚îÇ
‚îî‚îÄ‚îÄ –ê–ø—Ä–µ–ª—å (Sprint 4)
    ‚îú‚îÄ‚îÄ üìã Multi-tenant Schema
    ‚îú‚îÄ‚îÄ üìã Franchise Dashboard
    ‚îî‚îÄ‚îÄ üìã White-label Options
```

---

## 9. –ß–ï–ö–õ–ò–°–¢ –í–ù–ï–î–†–ï–ù–ò–Ø

### Sprint 0 (–î–µ–Ω—å 1)
```
‚ñ° Backup —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞
‚ñ° –û–±–Ω–æ–≤–∏—Ç—å frontend/src/types/users.ts
‚ñ° –ü–æ–∏—Å–∫ –∏ –∑–∞–º–µ–Ω–∞ ACCOUNTANT
‚ñ° –û–±–Ω–æ–≤–∏—Ç—å frontend/src/lib/utils.ts (currency)
‚ñ° –ü–æ–∏—Å–∫ –∏ –∑–∞–º–µ–Ω–∞ ‚ÇΩ ‚Üí —Å—É–º, RUB ‚Üí UZS
‚ñ° npm run build - –±–µ–∑ –æ—à–∏–±–æ–∫
‚ñ° npm run test - —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
‚ñ° –¢–µ—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö 7 —Ä–æ–ª–µ–π
```

### Sprint 1 (–ù–µ–¥–µ–ª—è 1)
```
‚ñ° –ó–∞–º–µ–Ω–∏—Ç—å Sidebar.tsx
‚ñ° –î–æ–±–∞–≤–∏—Ç—å data-tour –∞—Ç—Ä–∏–±—É—Ç—ã
‚ñ° npm install xlsx
‚ñ° –°–æ–∑–¥–∞—Ç—å ExportButton.tsx
‚ñ° –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –Ω–∞ machines, transactions, tasks
‚ñ° –°–æ–∑–¥–∞—Ç—å InlineCreateSelect.tsx
‚ñ° –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Ñ–æ—Ä–º—ã machines, products
‚ñ° –°–æ–∑–¥–∞—Ç—å ProductTour.tsx
‚ñ° –î–æ–±–∞–≤–∏—Ç—å –≤ dashboard layout
‚ñ° –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```

### Sprint 2 (–ù–µ–¥–µ–ª—è 2)
```
‚ñ° –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É /my/* —Å—Ç—Ä–∞–Ω–∏—Ü
‚ñ° –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Customer Dashboard
‚ñ° Backend API –¥–ª—è customer stats
‚ñ° –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
‚ñ° –ë–æ–Ω—É—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ)
‚ñ° –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ customer flow
```

### Sprint 3 (–ù–µ–¥–µ–ª—è 3)
```
‚ñ° –†–∞—Å—à–∏—Ä–∏—Ç—å Telegram –±–æ—Ç–∞
‚ñ° –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤
‚ñ° –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚ñ° –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ end-to-end
```

### Sprint 4 (–ù–µ–¥–µ–ª—è 4)
```
‚ñ° –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î –¥–ª—è organizations
‚ñ° Tenant middleware
‚ñ° UI –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
‚ñ° –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
```

---

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

| –ú–µ—Ç—Ä–∏–∫–∞ | –°–µ–π—á–∞—Å | –ü–æ—Å–ª–µ Sprint 4 |
|---------|--------|----------------|
| **UI/UX Score** | 75/100 | 90/100 |
| **Technical Score** | 82/100 | 92/100 |
| **Customer Experience** | 0/100 | 80/100 |
| **Telegram Coverage** | 70% | 95% |
| **Franchise Ready** | ‚ùå | ‚úÖ |

---

## üìé –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø

### A. –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- VHM24-UI-OPTIMIZATION-PLAN.md
- VHM24-LIQUID-ETHER-INTEGRATION.md
- VENDHUB-ECOSYSTEM-FINAL.md

### B. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

```
üéØ –û–°–ù–û–í–ù–û–ô (–≤—Å–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ —Å—é–¥–∞):
   ‚îî‚îÄ‚îÄ https://github.com/jamsmac/VHM24

üì¶ –î–û–ù–û–†–°–ö–ò–ï (–±—Ä–∞—Ç—å –ø–æ–ª–µ–∑–Ω—ã–µ –Ω–∞—Ä–∞–±–æ—Ç–∫–∏):
   ‚îú‚îÄ‚îÄ https://github.com/jamsmac/VendHub (legacy backend)
   ‚îú‚îÄ‚îÄ https://github.com/jamsmac/vendhub-showcase (UI –¥–µ–º–æ)
   ‚îú‚îÄ‚îÄ https://github.com/jamsmac/vendify-menu-maps (–ø—É–±–ª–∏—á–Ω–∞—è –∫–∞—Ä—Ç–∞)
   ‚îî‚îÄ‚îÄ https://github.com/jamsmac/vendhub-bot (Telegram)
```

---

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:** 23 –¥–µ–∫–∞–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏  
**–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~50 —á–∞—Å–æ–≤ (+ –≤–æ–∑–º–æ–∂–Ω–∞—è —ç–∫–æ–Ω–æ–º–∏—è ~38—á –∏–∑ –¥–æ–Ω–æ—Ä—Å–∫–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤)

---

> **VendHub ‚Äî –µ–¥–∏–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –≤–µ–Ω–¥–∏–Ω–≥–∞, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ —Å–∞–π—Ç, –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ Telegram, –æ–±—ä–µ–¥–∏–Ω—è—è –ø–æ–∫—É–ø–∫–∏, –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å–æ–º –≤ –æ–¥–Ω–æ–º –ø–æ–Ω—è—Ç–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ.**
